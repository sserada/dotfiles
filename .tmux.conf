# プレフィックスキー
# デフォルトのC-bからC-tに変更
set-option -g prefix C-t
unbind-key C-b
bind-key C-t send-prefix

# マウスモード
# マウスでのペイン選択・リサイズを有効化
set-option -g mouse on

# カラー設定
# 256色表示を有効にする
set-option -g default-terminal "screen-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# キーバインド
# `v`で左右分割、`s`で上下分割
bind v split-window -h
bind s split-window -v

# `C-`と`hjkl`でペインを移動する
bind -r C-h select-pane -L
bind -r C-j select-pane -D
bind -r C-k select-pane -U
bind -r C-l select-pane -R

# fzf連携 (ポップアップウィンドウ)
# prefix + F: セッションを選択
bind-key F display-popup -E "tmux list-sessions | sed -E 's/:.*$//' | fzf --reverse | xargs tmux switch-client -t"

# prefix + W: ウィンドウを選択
bind-key W display-popup -E "tmux list-windows -a | fzf --reverse | cut -d: -f1 | xargs tmux select-window -t"

# prefix + P: ペインを選択
bind-key P display-popup -E "tmux list-panes -a | fzf --reverse | cut -d: -f1 | xargs tmux select-pane -t"

# プラグインリスト
set -g @plugin 'tmux-plugins/tpm'                  # Tmux Plugin Manager
set -g @plugin 'tmux-plugins/tmux-resurrect'       # セッションの保存と復元
set -g @plugin 'tmux-plugins/tmux-continuum'       # セッションの自動保存と自動復元
set -g @plugin 'tmux-plugins/tmux-yank'            # OSクリップボード連携
set -g @plugin 'tmux-plugins/tmux-open'            # URLやファイルパスを開く
set -g @plugin 'egel/tmux-gruvbox'                 # gruvboxテーマ
set -g @plugin 'tmux-plugins/tmux-cpu'             # CPU使用率表示

# プラグインマネージャーを初期化 (この行は必ず最後に記述すること)
run '~/.tmux/plugins/tpm/tpm'

# ステータスラインのカスタム (テーマプラグインの設定を上書き)
set -g status-right '#(~/.tmux/plugins/tmux-cpu/scripts/cpu_percentage.sh) | %H:%M %Y/%m/%d'
